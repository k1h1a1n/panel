<div class="sync-listing-root">
  <!-- Folders View -->
  <div *ngIf="displayMode() === 'folders'">
    <header class="listing-header gradient">
      <div class="header-left">
        <div class="header-row">
          <button class="back" *ngIf="canGoBack" (click)="goBack()">←</button>
          <h2>{{ title() }}</h2>
        </div>
        <p class="subtitle">Browse folders and see image counts at-a-glance</p>
      </div>
      <div class="header-right">
        <div class="counts">
          <span class="count-item">Greetings <span class="badge">{{ greetingsCount() }}</span></span>
          <span class="count-item">Social <span class="badge">{{ socialCount() }}</span></span>
          <span class="count-item">Brochures <span class="badge">{{ brochureCount() }}</span></span>
        </div>
      </div>
      <div class="breadcrumb" *ngIf="breadcrumbPath.length">{{ displayBreadcrumb }}</div>
    </header>

    <div class="search-box">
      <input type="text" [value]="searchQuery()" (input)="searchQuery.set($any($event.target).value)" placeholder="Search folders..." />
    </div>

    <ul class="folder-list folder-grid">
      <li *ngFor="let folder of displayFolders" (click)="onFolderClick(folder)" class="folder-card">
        <div class="card-body">
          <div class="folder-name">{{ folder.DisplayName }}</div>
          <div class="folder-code" *ngIf="folder.Code">{{ folder.Code }}</div>
        </div>
        <div class="card-meta">
          <span class="count-badge">{{ (folder.imgList?.length || folder.imgs?.length || folder.images?.length) || 0 }}</span>
          <div class="chevron" *ngIf="folder.Folders && folder.Folders.length">›</div>
        </div>
      </li>
    </ul>

    <div *ngIf="displayFolders.length === 0 && currentFolders.length > 0" class="empty">No folders match your search</div>
    <div *ngIf="!currentFolders || currentFolders.length === 0" class="empty">No folders available</div>
  </div>

  <!-- Images View -->
  <div *ngIf="displayMode() === 'images'" class="images-container">
    <header class="listing-header">
      <button class="back" (click)="goBackToFolders()">← Back</button>
      <h2>Images Available for SYNC ({{ nonCommonImages.length }})</h2>
    </header>

    <!-- Image Grid -->
    <div class="images-grid">
      <div *ngFor="let image of paginatedImages" class="image-card">
        <img [src]="getImageSrc(image)" [alt]="image.imgNo" class="image" />
        <div class="image-info">
          <p class="image-id">{{ image.id }}</p>
          <p class="image-no">{{ image.imgNo }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="paginatedImages.length === 0" class="empty">No images to display</div>

    <!-- Sticky Paginator -->
    <div class="paginator-sticky">
      <button 
        class="page-btn prev-btn" 
        [disabled]="currentPage() === 1"
        (click)="goToPage(currentPage() - 1)">
        ← Previous
      </button>

      <div class="page-numbers">
        <button 
          *ngFor="let page of pageRange"
          class="page-btn"
          [class.active]="page === currentPage()"
          (click)="goToPage(page)">
          {{ page }}
        </button>
      </div>

      <button 
        class="page-btn next-btn" 
        [disabled]="currentPage() === totalPages"
        (click)="goToPage(currentPage() + 1)">
        Next →
      </button>

      <span class="page-info">Page {{ currentPage() }} of {{ totalPages }}</span>
    </div>

  </div>
</div>
